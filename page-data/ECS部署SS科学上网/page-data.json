{"componentChunkName":"component---src-templates-post-template-js","path":"/ECS部署SS科学上网/","webpackCompilationHash":"c350e791ebf0e69a7acf","result":{"data":{"post":{"id":"3aa72687-a7e4-5614-9f91-73980fca4458","html":"<p>1.安装shadowsocks</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pip <span class=\"token function\">install</span> shadowsocks</code></pre></div>\n<p>2.启动</p>\n<p>命令方式启动</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">sslocal -s 222.22.2.2 -p 222 -b 127.0.0.1 -l 1080 -k <span class=\"token function\">passwd</span> -t 600 -m aes-256-cfb</code></pre></div>\n<p>配置文件启动</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">sslocal -c shadowsocks.json</code></pre></div>\n<p>配置文件格式：</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n<span class=\"token property\">\"server\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"222.22.2.2\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"local_address\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"server_port\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">222</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"local_port\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">1080</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"password\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"passwd\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"timeout\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">600</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"method\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"aes-256-cfb\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"fast_open\"</span><span class=\"token operator\">:</span><span class=\"token boolean\">false</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>3.使用polipo进行二次转发</p>\n<p>安装polipo</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> polipo</code></pre></div>\n<p>配置polipo</p>\n<p>修改/etc/polipo/config</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">logSyslog <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\nlogFile <span class=\"token operator\">=</span> /var/log/polipo/polipo.log\n\nproxyAddress <span class=\"token operator\">=</span> <span class=\"token string\">\"0.0.0.0\"</span>\n\nsocksParentProxy <span class=\"token operator\">=</span> <span class=\"token string\">\"127.0.0.1:1080\"</span>\nsocksProxyType <span class=\"token operator\">=</span> socks5\n\nchunkHighMark <span class=\"token operator\">=</span> 50331648\nobjectHighMark <span class=\"token operator\">=</span> 16384\n\nserverMaxSlots <span class=\"token operator\">=</span> 64\nserverSlots <span class=\"token operator\">=</span> 16\nserverSlots1 <span class=\"token operator\">=</span> 32</code></pre></div>\n<p>重启polipo</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> /etc/init.d/polipo restart</code></pre></div>\n<p>polipo默认是运行在8123端口</p>\n<p>4.Python3使用shadowsocks代理</p>\n<p>shadowsocks使用的是socks5协议，需要Python支持socks5代理</p>\n<p>安装pysocks</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> pip <span class=\"token function\">install</span> pysocks</code></pre></div>\n<p>使用示例：</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> requests\n\nproxies<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'http'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'socks5://127.0.0.1:1080'</span><span class=\"token punctuation\">}</span>\nhtml<span class=\"token operator\">=</span>requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'http://httpbin.org/ip'</span><span class=\"token punctuation\">,</span>proxies<span class=\"token operator\">=</span>proxies<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">or</span>\n\n<span class=\"token keyword\">import</span> requests\n<span class=\"token keyword\">import</span> socks\n<span class=\"token keyword\">import</span> socket\n\nsocks<span class=\"token punctuation\">.</span>setdefaultproxy<span class=\"token punctuation\">(</span>socks<span class=\"token punctuation\">.</span>PROXY_TYPE_SOCKS5<span class=\"token punctuation\">,</span> <span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1080</span><span class=\"token punctuation\">)</span>\nsocket<span class=\"token punctuation\">.</span>socket <span class=\"token operator\">=</span> socks<span class=\"token punctuation\">.</span>socksocket\n\nhtml<span class=\"token operator\">=</span>requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token string\">'http://httpbin.org/ip'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span></code></pre></div>","fields":{"slug":"/ECS部署SS科学上网/","prefix":"2017-04-05"},"frontmatter":{"title":"ECS部署SS科学上网","author":"Jason Zeng","category":"ss","cover":{"childImageSharp":{"resize":{"src":"/static/8aef57e18e3d44821d793ff580b9238d/c83a6/clay-banks-765259-unsplash.jpg"}}}}},"authornote":{"id":"eeaf3f36-861e-5339-a4a4-e63a63ccd23c","html":"<p><a href=\"https://github.com/zenghongtu\">Jason Zeng</a></p>"},"site":{"siteMetadata":{"facebook":{"appId":"2349655921921608"}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/ECS部署SS科学上网/","next":{"id":"99bf69d6-7373-5a50-9b76-129feadbc6dc","fields":{"slug":"/PIL生成验证码/","prefix":"2017-07-28","source":"posts"},"frontmatter":{"title":"PIL生成验证码","category":"PIL"}},"source":"posts"}}}