{"componentChunkName":"component---src-templates-post-template-js","path":"/Docker 简单使用/","webpackCompilationHash":"c350e791ebf0e69a7acf","result":{"data":{"post":{"id":"dab9e6f3-6070-5638-a316-7db0ad54a1b8","html":"<h1>安装Docker</h1>\n<p>详见Docker官网：<a href=\"https://www.docker.com/\">https://www.docker.com/</a></p>\n<h1>Preparing Dockerfile</h1>\n<p>创建Dockerfile文件，修改username和userpasswd写入：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># setting base image</span>\nFROM debian\n\n <span class=\"token comment\"># new a directory for sshd to run</span>\nRUN <span class=\"token function\">mkdir</span> -p /var/run/sshd\n\n <span class=\"token comment\"># installing ssh server</span>\nRUN <span class=\"token function\">apt-get</span> update\nRUN <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y openssh-server\n\n <span class=\"token comment\"># installing sudo</span>\nRUN <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y <span class=\"token function\">sudo</span>\n\n <span class=\"token comment\"># make ssh services use IPv4 to let X11 forwarding work correctly</span>\nRUN <span class=\"token keyword\">echo</span> AddressFamily inet <span class=\"token operator\">>></span> /etc/ssh/sshd_config\n\n <span class=\"token comment\"># defining user account imformation</span>\nARG username<span class=\"token operator\">=</span>username  <span class=\"token comment\">#用户名</span>\nARG userpasswd<span class=\"token operator\">=</span>passwd  <span class=\"token comment\">#密码</span>\n\n <span class=\"token comment\"># adding user</span>\nRUN <span class=\"token function\">useradd</span> -ms /bin/bash <span class=\"token variable\">$username</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>echo <span class=\"token variable\">$username</span><span class=\"token keyword\">:</span><span class=\"token variable\">$userpasswd</span> <span class=\"token operator\">|</span> chpasswd<span class=\"token punctuation\">)</span>\n\n <span class=\"token comment\"># adding user to sudo group</span>\nRUN adduser <span class=\"token variable\">$username</span> <span class=\"token function\">sudo</span>\n\n <span class=\"token comment\"># setting running application</span>\nCMD /usr/sbin/sshd -D</code></pre></div>\n<h1>Building Docker Image</h1>\n<p>在Dockerfile文件目录下执行以下命令构建镜像</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker build -t linux-debian <span class=\"token keyword\">.</span></code></pre></div>\n<p>查看镜像</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nlinux-debian        latest              9dede0b26399        28 hours ago        210MB\ndebian              latest              6d83de432e98        5 weeks ago         100MB</code></pre></div>\n<h1>创建Debian容器</h1>\n<p>镜像构建完成后，执行以下命令创建容器</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker create --name<span class=\"token operator\">=</span>linux -p 20022:22 linux-debian</code></pre></div>\n<p>查看容器</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker <span class=\"token function\">ps</span> -a</code></pre></div>\n<p>启动容器</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker start linux</code></pre></div>\n<h1>配置SSH免密登录</h1>\n<p>登录到创建的linux</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ssh</span> -p 20022 username@127.0.0.1</code></pre></div>\n<p>查看自己电脑~/.ssh/目录下是否已存在秘钥对，不存在则创建</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ssh-keygen -t rsa</code></pre></div>\n<p>将公钥<code class=\"language-text\">~/.ssh/id_rsa.pub</code>的内容填入linux中的<code class=\"language-text\">~/.ssh/authorized_keys</code>文件，并修改权限</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">chmod</span> 600 ~/.ssh/authorized_keys</code></pre></div>","fields":{"slug":"/Docker 简单使用/","prefix":"2017-11-25"},"frontmatter":{"title":"Docker 简单使用","author":"Jason Zeng","category":"Docker","cover":{"childImageSharp":{"resize":{"src":"/static/521769e1c2c079361c1317119a756b70/c83a6/cat3.jpg"}}}}},"authornote":{"id":"eeaf3f36-861e-5339-a4a4-e63a63ccd23c","html":"<p><a href=\"https://github.com/zenghongtu\">Jason Zeng</a></p>"},"site":{"siteMetadata":{"facebook":{"appId":"2349655921921608"}}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/Docker 简单使用/","prev":{"id":"99bf69d6-7373-5a50-9b76-129feadbc6dc","fields":{"slug":"/PIL生成验证码/","prefix":"2017-07-28","source":"posts"},"frontmatter":{"title":"PIL生成验证码","category":"PIL"}},"next":{"id":"d28c7c63-1414-59b8-bded-dec22f2c4934","fields":{"slug":"/破解Geetest极验滑动验证码/","prefix":"2017-12-25","source":"posts"},"frontmatter":{"title":"破解Geetest极验滑动验证码","category":"爬虫"}},"source":"posts"}}}