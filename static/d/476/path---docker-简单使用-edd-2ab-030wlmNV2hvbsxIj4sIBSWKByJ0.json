{"data":{"post":{"id":"95bad328-c9c6-5446-a4e2-beefb4d0ff85","html":"<p>title: Docker 简单使用\nauthor: 大图\ntags:</p>\n<ul>\n<li>docker\ncategories:</li>\n<li>\n<p>docker\ndate: 2017-11-25 14:37:00</p>\n<hr>\n</li>\n</ul>\n<h1>安装Docker</h1>\n<p>详见Docker官网：<a href=\"https://www.docker.com/\">https://www.docker.com/</a></p>\n<h1>Preparing Dockerfile</h1>\n<p>创建Dockerfile文件，修改username和userpasswd写入：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># setting base image\nFROM debian\n\n # new a directory for sshd to run\nRUN mkdir -p /var/run/sshd\n\n # installing ssh server\nRUN apt-get update\nRUN apt-get install -y openssh-server\n\n # installing sudo\nRUN apt-get install -y sudo\n\n # make ssh services use IPv4 to let X11 forwarding work correctly\nRUN echo AddressFamily inet &gt;&gt; /etc/ssh/sshd_config\n\n # defining user account imformation\nARG username=username  #用户名\nARG userpasswd=passwd  #密码\n\n # adding user\nRUN useradd -ms /bin/bash $username &amp;&amp; (echo $username:$userpasswd | chpasswd)\n\n # adding user to sudo group\nRUN adduser $username sudo\n\n # setting running application\nCMD /usr/sbin/sshd -D</code></pre></div>\n<h1>Building Docker Image</h1>\n<p>在Dockerfile文件目录下执行以下命令构建镜像</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker build -t linux-debian .</code></pre></div>\n<p>查看镜像</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nlinux-debian        latest              9dede0b26399        28 hours ago        210MB\ndebian              latest              6d83de432e98        5 weeks ago         100MB</code></pre></div>\n<h1>创建Debian容器</h1>\n<p>镜像构建完成后，执行以下命令创建容器</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker create --name=linux -p 20022:22 linux-debian</code></pre></div>\n<p>查看容器</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker ps -a</code></pre></div>\n<p>启动容器</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker start linux</code></pre></div>\n<h1>配置SSH免密登录</h1>\n<p>登录到创建的linux</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ssh -p 20022 username@127.0.0.1</code></pre></div>\n<p>查看自己电脑~/.ssh/目录下是否已存在秘钥对，不存在则创建</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ssh-keygen -t rsa</code></pre></div>\n<p>将公钥<code class=\"language-text\">~/.ssh/id_rsa.pub</code>的内容填入linux中的<code class=\"language-text\">~/.ssh/authorized_keys</code>文件，并修改权限</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">chmod 600 ~/.ssh/authorized_keys</code></pre></div>","fields":{"slug":"/Docker-简单使用/","prefix":null},"frontmatter":{"title":"","author":null,"category":null,"cover":null}},"authornote":{"id":"f3ffdeef-a16f-507d-9f2f-98fa5e045d0b","html":"<p><strong>Mr. Gatsby</strong> Proin ornare ligula eu tellus tempus elementum. Aenean <a href=\"/\">bibendum</a> iaculis mi, nec blandit lacus interdum vitae. Vestibulum non nibh risus, a scelerisque purus. Blandit lacus interdum vitae. Vestibulum non nibh risus, a scelerisque purus.</p>"},"site":{"siteMetadata":{"facebook":{"appId":""}}}},"pageContext":{"slug":"/Docker-简单使用/","next":{"id":"1af5e9de-8dc1-52c5-9dd5-84f80250877d","fields":{"slug":"/draft-post/","prefix":null,"source":"posts"},"frontmatter":{"title":"This is a draft post","category":"sayings"}},"source":"posts"}}